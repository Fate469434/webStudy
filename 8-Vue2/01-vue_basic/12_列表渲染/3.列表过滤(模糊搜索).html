<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<title>列表过滤</title>
	<script type="text/javascript" src="../js/vue.js"></script>
</head>

<body>
	<!-- 准备好一个容器-->
	<div id="root">
		<h2>人员列表</h2>
		<input type="text" placeholder="请输入名字" v-model="keyWord">
		<ul>
			<li v-for="(p,index) in filterPersons" :key="index">
				{{p.name}}-{{p.age}}-{{p.sex}}
			</li>
		</ul>
	</div>

	<script type="text/javascript">

		// 1. 使用监视/侦听属性实现
		// new Vue({
		// 	el:'#root',
		// 	data:{
		// 		keyWord:'',
		// 		persons:[
		// 			{id:'001',name:'马冬梅',age:19,sex:'女'},
		// 			{id:'002',name:'周冬雨',age:20,sex:'女'},
		// 			{id:'003',name:'周杰伦',age:21,sex:'男'},
		// 			{id:'004',name:'温兆伦',age:22,sex:'男'}
		// 		],
		// 		filterPersons:[]
		// 	},
		// 	watch:{
		// 		keyWord:{
		// 			immediate:true,
		// 			handler(newValue){
		// 				this.filterPersons=this.persons.filter(function(p){
		// 					return p.name.includes(newValue)===true
		// 				})
		// 			}
		// 		}
		// 	}
		// }) 

		// 2. 使用计算属性实现
		const vm = new Vue({
			el: '#root',
			data: {
				keyWord: '',
				persons: [
					{ id: '001', name: '马冬梅', age: 19, sex: '女' },
					{ id: '002', name: '周冬雨', age: 20, sex: '女' },
					{ id: '003', name: '周杰伦', age: 21, sex: '男' },
					{ id: '004', name: '温兆伦', age: 22, sex: '男' }
				],
			},
			computed: {
				filterPersons: {
					get() {
						let arr=[]
						for(let k in this.persons){
							if(this.persons[k].name.includes(this.keyWord)){
								arr.push(this.persons[k])
							}
						}
						return arr
						
						// 莫名其妙报错：
						return this.persons.filter(function(per){
							return per.name.includes(this.keyWord)===true
						})

						// 不报错：
						// return this.persons.filter((per)=>{
						// 	return per.name.includes(this.keyWord)===true
						// })
					}
				}
			},
		}) 
	</script>

</html>